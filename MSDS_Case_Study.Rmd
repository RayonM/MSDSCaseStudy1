---
title: "MSDS CaseStudy-1"
author: "Rayon M"
date: "6/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Install all needed R libraries and packages.


```{r}
library(tidyverse)
library(ggthemes)
library(ggplot2)
library(plotly)

```

#load the data

```{r}
#Load beers data
beers = read.csv(choose.files())

#Load breweries data
breweries = read.csv(choose.files())

```

# How many breweries are present in each state?

```{r, echo=FALSE}

totals = count(breweries, State)
colnames(totals)[2] ="Count"

totals %>% ggplot(mapping = aes(x = State, y = Count)) +
  geom_bar(stat = "identity", color = "black", fill = "brown" )+
  xlab("States")  + ylab("Number of Breweries")+
  geom_text(aes(State, Count+9, label = Count), data = totals)+
  ggtitle("Breweries per State")+
  theme_fivethirtyeight()

breweries




```


# MergeMerge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  (RMD only, this does not need to be included in the presentation or the deck.)

```{r}
beers_Breweries = merge(beers, breweries, by.x = "Brewery_id", by.y = "Brew_ID")

head(beers_Breweries)
tail(beers_Breweries)

beersNbreweries = na.omit(beers_Breweries)
Sums = count(beersNbreweries, State)
colnames(Sums)[2] = "Count"

beersNbreweries %>% ggplot(mapping = aes(x = State)) +
  geom_bar(color = "black", fill = "brown" )+
  xlab("States")  + ylab("Number of Breweries")+
  geom_text(aes(State, Count+3, label = Count), data = Sums)+
  ggtitle("Breweries per State")+
  theme_fivethirtyeight()

?geom_text
```

# Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

```{r}

ABV_State_Median_Plot = beersNbreweries %>% group_by(State) %>% summarize(ABV_State_median = median(ABV)) %>%
  ggplot(mapping = aes(y = ABV_State_median, x = State, stroke = 3))+
  geom_point(color = "brown", fill = "black")+
  theme_excel()+
  ggtitle("Mean Alcohol Content per State") + xlab("STATES") + ylab ("ABV Mean")
  ggplotly(ABV_State_Median_Plot)


g1 = beersNbreweries %>% group_by(State) %>% summarize(ABV_State_median = median(ABV)) # Throw away code
write.csv(g1, "ABV_mean.csv") # Throw away code

g2 = beersNbreweries %>% group_by(State) %>% summarize(IBU_State_median = median(IBU))
write.csv(g2, "IBU_mean.csv")

IBU_State_Median_Plot = beersNbreweries %>% group_by(State) %>% summarize(IBU_State_median = median(IBU)) %>%
  ggplot(mapping = aes(y = IBU_State_median, x = State, stroke = 3))+
  geom_point(color = "brown", fill = "black")+
  theme_excel()+
  ggtitle("Mean Internation Bitterness Unit per State") + xlab("STATES") + ylab ("IBU Mean")
  ggplotly(IBU_State_Median_Plot)

```
# Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r}

```

# Comment on the summary statistics and distribution of the ABV variable.

```{r}

````

# Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.  Make your best judgment of a relationship and EXPLAIN your answer

```{r}

```

#Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).  You decide to use KNN classification to investigate this relationship.  Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.


```{r}


```

