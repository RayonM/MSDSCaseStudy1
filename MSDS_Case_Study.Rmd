---
title: "MSDS CaseStudy-1"
author: "Rayon M"
date: "6/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction

Good day Mr. CEO & CFO. I'd like to thank you for accepting my invitation. Today, I'd like to address the questions you recently posed during our last Steering Committee meeting and provide you with a brief analysis that may pique your interest. This research was done using the Beer and Breweries data provided. 


```{r}

# Install all needed R libraries and packages.

library(tidyverse)
library(ggthemes)
library(ggplot2)
library(plotly)
library(GGally)
library(caret)
library(maps)
library(mapproj)
library(dplyr)
#library(stringi)
#library(stringr)

```

#Cookbook

```{r}

#Load beers data
beers = read.csv(file.choose())

#Load breweries data
breweries = read.csv(file.choose())


#Quick look at the dataframe for both datasets.
head(beers)
head(breweries)

```

# How many breweries are present in each state?

```{r}

#Use the breweries dataset to count the number of breweries present in each State.
#This data will be stored in the variable "breweries_Count_State."
breweries_Count_State = dplyr::count(breweries,State)


#Rename the column n to a recognizable name.
colnames(breweries_Count_State)[2] ="Count"

####Changed count to 2 to make it more legible
#Here I'm using the totals variable to display the number of breweries per State.
breweries_Count_State %>% ggplot(mapping = aes(x = State, y = Count)) +
  geom_bar(stat = "identity", color = "black", fill = "grey" )+
  xlab("States")  + ylab("Count of Breweries")+
  geom_text(aes(State, Count+1, label = Count), data = breweries_Count_State, col="brown")+
  ggtitle("Breweries per State")+
  theme_tufte()
 
```

### Tried adding labels 
### snames <- data.frame(region=tolower(state.name), long=state.center$x, lat=state.center$y)
####snames <- merge(snames, map.df, by="region")
###3ggplot(snames, aes(x=long, y=lat)) + geom_polygon(aes(group=group, fill=count)) + #### ### geom_text(data=snames, aes(x=long, y=lat, label=count))

# Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  (RMD only, this does not need to be included in the presentation or the deck.)

```{r}

beers_Breweries = merge(beers, breweries, by.x = "Brewery_id", by.y = "Brew_ID")

beers_Breweries

write.csv(beers_Breweries, "missingdataincluded.csv")

head(beers_Breweries)
tail(beers_Breweries)

#Rename the columns Name.x and Name.y to be more meaningful names.
colnames(beers_Breweries)[2] = "Beer_Name"
colnames(beers_Breweries)[8] = "Brewery_Name"

#The following columns had NA values/missing data: ABV, IBU, and Styles(these were blank and Not N/A). To Tidy the data, we excluded those values from the dataset. We do not have a way to find those data points at this time. 
beersNbreweries = na.omit(beers_Breweries)#Thinking about changing the name to cleanBeersNBreweries

Sums = dplyr::count(beersNbreweries,State)
colnames(Sums)[2] = "Count"

#Doesn't seem like it's need for the question 2. May strip out in final presentation.
beersNbreweries %>% ggplot(mapping = aes(x = State)) +
  geom_bar(color = "black", fill = "brown" )+
  xlab("States")  + ylab("Number of Breweries")+
  geom_text(aes(State, Count+3, label = Count), data = Sums)+
  ggtitle("Breweries per State")+
  theme_fivethirtyeight()

```

# Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

```{r}
#### Did you rename state to abb?
#Compute the median the ABV (alcohol content) for each state.
ABV_Median_State = beersNbreweries %>% group_by(State) %>% dplyr::summarize(ABV_Median = median(ABV), count = n())
ABV_Median_State

#Plot a bar chart
ABV_Median_State %>% ggplot(mapping = aes(x= State, y = ABV_Median)) +
  geom_bar(stat = "identity",color = "darkgrey", fill = "darkslategray4")+
  geom_text(aes(State, ABV_Median+0.002, label = ABV_Median), data = ABV_Median_State, size=2.3)+ #Added labels to the chart
  theme_tufte()+
  ggtitle("Median ABV per State") + xlab("STATES") + ylab ("ABV Mean")

#Compute the median IBU (International bitterness Unit)
IBU_Median_State = beersNbreweries %>% group_by(State) %>% dplyr::summarize(IBU_Median = median(IBU), count= n())
IBU_Median_State

#Plot a bar chart
  IBU_Median_State %>% ggplot(mapping = aes(x= State, y = IBU_Median )) +
  geom_bar(stat = "identity",color = "darkgrey", fill = "darkslategray4")+ 
  geom_text(aes(State, IBU_Median+1, label = IBU_Median), data = IBU_Median_State, size=4)+ #Added labels to the chart
  theme_tufte()+
  ggtitle("Median IBU per State") + xlab("STATES") + ylab ("IBU Mean")
  
```
# Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r}
# Finds the Max number within the ABV variable and the row number (index) in which the maximum ABV number may be found.
 
state_Max_ABV = beersNbreweries %>% summarise(Max_ABV= max(ABV), row_Index = which.max(ABV))
state_Max_ABV # The maximum ABV is 0.125 and can be found in row 8.

#Uses the row number (8) from above to find the State that coincides with the maximum ABV. 
beersNbreweries$State[8]
#The State is Kentucky (KY).

# Find the Max number within the IBU variable and the row number (index) in which the maximum IBU number may be found.

state_Max_IBU = beersNbreweries %>% summarise(Max_IBU= max(IBU), row_Index = which.max(IBU))
state_Max_IBU # The maximum IBU is 138 and can be found in row 1134.

#Uses the row number (1134) from above to find the State that coincides with the maximum IBU.
beersNbreweries$State[1134]
#The State is Oregon (OR).

```

# Comment on the summary statistics and distribution of the ABV variable.

```{r}

#Statistics of the ABV variable
beersNbreweries %>%
  group_by(State) %>%
  dplyr::summarize(mean = mean(ABV), sd = sd(ABV), median = median(ABV), range = max(ABV)- min(ABV), IQR = IQR(ABV), count = n())

#Box Plot to show the Statistics of the ABV variable.
beersNbreweries %>% 
  ggplot(mapping = aes(x = ABV))+
  geom_boxplot(color = "darkgrey", fill = "darkslategray4")+
  ggtitle("ABV Variable Box Plot")+
  theme_tufte()


# I Created a Histogram of ABV to see its distribution.
beersNbreweries %>% ggplot(mapping = aes(x = ABV))+
  geom_histogram(color = "darkgrey", fill = "darkslategray4")+
  theme_tufte()+
  ggtitle("Histogram of ABV") + xlab("ABV Values") + ylab ("Count")

# The distribution of the ABV variable is right skewed.


```

# Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.  Make your best judgment of a relationship and EXPLAIN your answer

```{r}
#Scatter Plot showing the distribution of the ABV versus the IBU variables.

g = beersNbreweries %>% ggplot(mapping = aes(x = ABV, y = IBU, position ="jitter", stroke = 1)) +
  geom_point(color = "brown")+
  theme_tufte()+
  xlab("ABV") + ylab("IBU")+
  ggtitle("Relationship between bitterness and Alcohol content")+
  geom_smooth(aes(x = ABV, y = IBU))

ggplotly(g)


# The relationship between the ABV and IBU appears to be positively linear. As the ABV increases we can see that IBU also increases. There is a cluster around the 0.050 ABV value, indicating that a great majority of beers try to stay near that number.In our data set most of the ABV data was below the 0.100 ABV value. There were only two beers that went above that number.However, the IBU values was not as high as expected given that the trend is linear. These two beers were in the States of Indiana and Kentucky. 


```

#Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).  You decide to use KNN classification to investigate this relationship.  Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.


```{r}
#Due June 26th


(grep("SUSHI", df_Baltimore_Restaurants$name))
length(grep("SUSHI", df_Baltimore_Restaurants$name))
sum(grepl("SUSHI", df_Baltimore_Restaurants$name))
which(grepl("SUSHI", df_Baltimore_Restaurants$name))
which(grepl("0.125",beersNbreweries$State))
```

